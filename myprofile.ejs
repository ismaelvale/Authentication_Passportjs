<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Profile</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>
</head>
<body>
    <h1><a href="/">Ismagram</a></h1>
    <% if (user) {%>
        <h1>WELCOME BACK <%= user.username %></h1>
        <a href="/log-out">LOG OUT</a> <% } %>   
    <div class="container">
        <% if (user.profilePhoto) { %>
            <div class="d-grid gap-2 col-6 mx-auto">
                <img src="<%= user.profilePhoto %>" class="rounded-circle mx-auto" style="width: 200px; height: 220px;">
            </div>
        <% } else { %>
            <form action="/updatePhoto" method="POST" enctype="multipart/form-data">
                <div class="d-grid gap-2 col-6 mx-auto">
                    <button class="rounded-circle mx-auto" style="width: 200px; height: 220px;">
                        <input id="file-upload" class="form-control" type="file" name="profilePhoto" accept="image/*" placeholder="Add an image">
                        <label for="file-upload" class="text-center text-wrap lh-sm mt-1 mb-0">Upload Profile Photo</label>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-circle" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-7.5 3.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V11.5z"/>
                        </svg>
                    </button>
                </div> 
            </form> <% } %>
        <div class="container">
            <h4 class="text-center"><%= user.fullName %></h4>
            <p class="text-center"><%= user.username %></p>
        </div>
    </div>
        <!-- <button class="btn">edit profile</button> -->
    <div class="d-flex justify-content-around border align-items-center">
        <p class="fw-semibold align-middle my-0"><%=Object.keys(messages).length %> posts</p>
        <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
            <p class="fw-semibold align-middle my-0"><%= user.followers.length %> followers</p>   
        </button>
        <%- include('./followers.ejs')%>
        <p class="fw-semibold align-middle my-0"><%= user.following.length %> following</p>
    </div>
        <p class="text-center fw-semibold">Previous Posts</p>
        <div class="container text-center">
            <div class="container text-center">
                <div class="row mx-auto">
                    <% messages.forEach(function(message) { -%>
                    <div class="col" style="width: 161px; height: 161px;">
                        <a href="/message-focus">
                            <img class="img-fluid" src="<%= message.image %>">
                        </a>
                    </div> <% }) %>
                </div>
            </div>
        </div>
    </div> 
</body>
</html>